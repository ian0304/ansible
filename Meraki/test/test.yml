---
- name: Test
  hosts: localhost
  gather_facts: false
  vars:
    org_id: "1563867"
    corp_name: "networkguy.online"

  tasks:
    - name: Get all networks
      cisco.meraki.networks_info:
        organizationId: "{{ org_id }}"
        tags: [Office]
        tagsFilterType: withAllTags
      register: result

    - name: Filter networks ID
      set_fact:
        Networkidlist: "{{ result.meraki_response | map(attribute='id') | list }}"

    - name: Show Networkidlist
      ansible.builtin.debug:
        msg: "{{ Networkidlist }}"

    - name: Get all devices
      cisco.meraki.devices_info:
        organizationId: 1563867
      networkIds:
          L_699746792102694192
      register: networkdevices

    - name: Get management interface info
      cisco.meraki.devices_management_interface_info:
        serial: "{{ devicesn[0] }}"
      register: result

    - name: Show all devices
      set_fact: 
        devicesn: "{{ networkdevices | json_query('meraki_response[*].serial') | list }}"